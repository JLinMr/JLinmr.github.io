{"version":3,"file":"../../js/utils.js","names":["anzhiyu","debounce","func","wait","immediate","timeout","args","callNow","clearTimeout","setTimeout","throttle","options","context","previous","later","leading","Date","getTime","apply","params","now","remaining","this","trailing","sidebarPaddingR","innerWidth","window","clientWidth","document","body","paddingRight","style","snackbarShow","text","showActionFunction","duration","actionText","position","bgLight","bgDark","GLOBAL_CONFIG","Snackbar","bg","documentElement","getAttribute","querySelector","setProperty","show","backgroundColor","onActionClick","showAction","pos","customClass","loadComment","dom","callback","observerItem","IntersectionObserver","entries","isIntersecting","disconnect","threshold","observe","scrollToDest","time","currentPos","pageYOffset","scrollTo","top","behavior","start","requestAnimationFrame","step","currentTime","progress","initJustifiedGallery","selector","runJustifiedGallery","i","isHidden","fjGallery","itemSelector","rowHeight","gutter","onJustify","$container","opacity","Array","from","length","forEach","animateIn","ele","display","animation","animateOut","addEventListener","f","removeEventListener","wrap","eleType","creatEle","createElement","key","value","Object","setAttribute","parentNode","insertBefore","appendChild","offsetHeight","offsetWidth","getEleTop","actualTop","offsetTop","current","offsetParent","loadLightbox","service","lightbox","zoom","mediumZoom","on","e","photoBg","update","background","tagName","dataSrc","dataset","lazySrc","src","dataCaption","title","alt","href","fancyboxRun","Fancybox","bind","Hash","Thumbs","autoStart","setLoading","add","insertAdjacentHTML","remove","nextElementSibling","updateAnchor","anchor","location","hash","pathname","GLOBAL_CONFIG_SITE","history","replaceState","url","getScrollPercent","currentTop","docHeight","clientHeight","winHeight","scrollPercent","scrollHeight","scrollPercentRounded","Math","round","addGlobalFn","fn","name","parent","globalFn","keyObj","keys","addEventListenerPjax","event","option","removeGlobalFnEvent","keyArr","changeThemeMetaColor","color","themeColorMeta","initThemeColor","themeColor","getComputedStyle","getPropertyValue","trim","replace","scrollY","scrollTop","is_Post","indexOf","addNavBackgroundInit","bodyScrollTop","documentScrollTop","$bodyWrap","pageHeaderEl","classList","downloadImage","imgsrc","rm","hideRightMenu","downloadimging","image","Image","onload","canvas","width","height","getContext","drawImage","toDataURL","a","MouseEvent","download","dispatchEvent","stopImgRightDrag","img","getElementsByTagName","id","domTop","hideAsideBtn","$htmlDom","contains","saveToLocal","set","toggle","switchCommentBarrage","commentBarrage","menuCommentBarrageText","consoleCommentBarrage","textContent","localStorage","setItem","removeItem","initPaginationObserver","commentElement","getElementById","paginationElement","entry","bottom","initIndexEssay","checkSwiper","retryCount","maxRetries","Swiper","essay_bar_swiper","passiveListeners","direction","loop","autoplay","disableOnInteraction","delay","mousewheel","essay_bar_comtainer","onmouseenter","stop","onmouseleave","error","console","warn","scrollByMouseWheel","$list","$target","scrollLeft","wheelDelta","preventDefault","passive","offsetLeft","catalogActive","decodeURIComponent","catalogListItems","querySelectorAll","$catalog","item","startsWith","tagsPageActive","$tagPageTags","diffDate","d","more","simple","dateNow","datePost","dateDiff","minute","hour","day","month","result","dayCount","hourCount","minuteCount","toLocaleDateString","parseInt","date_suffix","min","just","getMonth","getDate","changeTimeInEssay","t","datetime","innerText","changeTimeInAlbumDetail","reflashEssayWaterFall","waterfallEl","waterfall","sayhi","$sayhiEl","innerHTML","getHours","message","getTimeState","addFriendLink","input","getElementsByClassName","evt","Event","cancelable","bubbles","getConfigIfPresent","linkPageTop","focus","setSelectionRange","config","configKey","defaultValue","hasOwnProperty","musicToggle","changePaly","anzhiyu_musicFirst","musicBindEvent","anzhiyu_musicPlaying","navMusicEl","aplayer","musicTelescopic","musicSkipBack","skipBack","musicSkipForward","skipForward","musicGetName","x","arr","initConsoleState","rewardShowConsole","consoleEl","showConsole","hideConsole","centerConsole","checked","hideLoading","cacheAndPlayMusic","data","getItem","JSON","parse","timestamp","playMusic","songs","fetch","then","response","json","cacheData","stringify","metingAplayer","randomSong","floor","random","allAudios","list","audios","selectRandomSong","includes","songFound","newRandomSong","switch","push","palyMusicIndex","findIndex","song","info","changeMusicBg","isChangeBg","anMusicBg","musiccover","backgroundImage","timer","setInterval","clearInterval","addEventListenerMusic","audio","paused","getCustomPlayList","urlParams","URLSearchParams","search","anMusicPageMeting","get","server","hideTodayCard","anMusicPage","aplayerIconMenu","anMusicBtnGetSong","anMusicRefreshBtn","anMusicSwitchingBtn","volume","anMusicPageMenuAask","changeMusicListFlag","randomIndex","changeMusicList","music_page_default","code","keyCode","musicVolume","async","defaultPlayMusicList","clear","addEventListenerConsoleMusicList","navMusic","aplayerList","listBtn","target","toPage","toPageText","toPageButton","pageNumbers","lastPageNumber","Number","pageNumber","isNaN","isInteger","removeBodyPaceClass","className","setValueToBodyType","type","addRandomCommentInfo","adjectives","vegetablesAndFruits","lauthor","lmail","author","j","mail","visitorMail","dr_js_autofill_commentinfos","totraveling","open","replaceAll","n","split","join","hasMobile","isMobile","navigator","userAgent","match","qrcodeCreate","QRCode","colorDark","colorLight","correctLevel","CorrectLevel","H","isInViewPortOfOne","el","viewPortHeight","innerHeight","addRewardMask","zIndex","removeRewardMask","keyboardToggle","isKeyboardOn","anzhiyu_keyboard","rightMenuToggle","oncontextmenu","oncontextmenuFunction","switchConsole","consoleKeyboard","intersectionObserver","enterCallback","leaveCallback","observer","intersectionRatio","scrollCategoryBarToRight","items","nextButton","itemsWidth","scrollWidth","scroll","left","scrollBy","categoriesBarActive","urlinfo","$categoryBar","test","nowCategorie","topCategoriesBarScroll","$categoryBarItems","v","switchRightClickMenuHotReview","postComment","menuCommentBarrageDom","changeSayHelloText","greetings","authorStatus","skills","authorInfoSayHiElement","lastSayHello","randomGreeting","anzhiyuPopupManager","queue","processing","Jump","enqueuePopup","tip","processQueue","shift","popupShow","popupWindow","windowTitle","cookiesTip","clickEventHandler","pjax","loadUrl"],"sources":["js/utils.js"],"mappings":"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","ignoreList":[],"sourcesContent":["const anzhiyu = {\n  debounce: (func, wait = 0, immediate = false) => {\n    let timeout;\n    return (...args) => {\n      const later = () => {\n        timeout = null;\n        if (!immediate) func(...args);\n      };\n      const callNow = immediate && !timeout;\n      clearTimeout(timeout);\n      timeout = setTimeout(later, wait);\n      if (callNow) func(...args);\n    };\n  },\n\n  throttle: function (func, wait, options = {}) {\n    let timeout, context, args;\n    let previous = 0;\n\n    const later = () => {\n      previous = options.leading === false ? 0 : new Date().getTime();\n      timeout = null;\n      func.apply(context, args);\n      if (!timeout) context = args = null;\n    };\n\n    const throttled = (...params) => {\n      const now = new Date().getTime();\n      if (!previous && options.leading === false) previous = now;\n      const remaining = wait - (now - previous);\n      context = this;\n      args = params;\n      if (remaining <= 0 || remaining > wait) {\n        if (timeout) {\n          clearTimeout(timeout);\n          timeout = null;\n        }\n        previous = now;\n        func.apply(context, args);\n        if (!timeout) context = args = null;\n      } else if (!timeout && options.trailing !== false) {\n        timeout = setTimeout(later, remaining);\n      }\n    };\n\n    return throttled;\n  },\n\n  sidebarPaddingR: () => {\n    const innerWidth = window.innerWidth;\n    const clientWidth = document.body.clientWidth;\n    const paddingRight = innerWidth - clientWidth;\n    if (innerWidth !== clientWidth) {\n      document.body.style.paddingRight = paddingRight + \"px\";\n    }\n  },\n\n  snackbarShow: (text, showActionFunction = false, duration = 2000, actionText = false) => {\n    const { position, bgLight, bgDark } = GLOBAL_CONFIG.Snackbar;\n    const bg = document.documentElement.getAttribute(\"data-theme\") === \"light\" ? bgLight : bgDark;\n    const root = document.querySelector(\":root\");\n    root.style.setProperty(\"--anzhiyu-snackbar-time\", duration + \"ms\");\n\n    Snackbar.show({\n      text: text,\n      backgroundColor: bg,\n      onActionClick: showActionFunction,\n      actionText: actionText,\n      showAction: actionText,\n      duration: duration,\n      pos: position,\n      customClass: \"snackbar-css\",\n    });\n  },\n\n  loadComment: (dom, callback) => {\n    if (\"IntersectionObserver\" in window) {\n      const observerItem = new IntersectionObserver(\n        entries => {\n          if (entries[0].isIntersecting) {\n            callback();\n            observerItem.disconnect();\n          }\n        },\n        { threshold: [0] }\n      );\n      observerItem.observe(dom);\n    } else {\n      callback();\n    }\n  },\n\n  scrollToDest: (pos, time = 500) => {\n    const currentPos = window.pageYOffset;\n    if (\"scrollBehavior\" in document.documentElement.style) {\n      window.scrollTo({\n        top: pos,\n        behavior: \"smooth\",\n      });\n      return;\n    }\n\n    let start = null;\n    pos = +pos;\n    window.requestAnimationFrame(function step(currentTime) {\n      start = !start ? currentTime : start;\n      const progress = currentTime - start;\n      if (currentPos < pos) {\n        window.scrollTo(0, ((pos - currentPos) * progress) / time + currentPos);\n      } else {\n        window.scrollTo(0, currentPos - ((currentPos - pos) * progress) / time);\n      }\n      if (progress < time) {\n        window.requestAnimationFrame(step);\n      } else {\n        window.scrollTo(0, pos);\n      }\n    });\n  },\n\n  initJustifiedGallery: function (selector) {\n    const runJustifiedGallery = i => {\n      if (!anzhiyu.isHidden(i)) {\n        fjGallery(i, {\n          itemSelector: \".fj-gallery-item\",\n          rowHeight: i.getAttribute(\"data-rowHeight\"),\n          gutter: 4,\n          onJustify: function () {\n            this.$container.style.opacity = \"1\";\n          },\n        });\n      }\n    };\n\n    if (Array.from(selector).length === 0) runJustifiedGallery(selector);\n    else\n      selector.forEach(i => {\n        runJustifiedGallery(i);\n      });\n  },\n\n  animateIn: (ele, text) => {\n    ele.style.display = \"block\";\n    ele.style.animation = text;\n  },\n\n  animateOut: (ele, text) => {\n    ele.addEventListener(\"animationend\", function f() {\n      ele.style.display = \"\";\n      ele.style.animation = \"\";\n      ele.removeEventListener(\"animationend\", f);\n    });\n    ele.style.animation = text;\n  },\n\n  /**\n   * @param {*} selector\n   * @param {*} eleType the type of create element\n   * @param {*} options object key: value\n   */\n  wrap: (selector, eleType, options) => {\n    const creatEle = document.createElement(eleType);\n    for (const [key, value] of Object.entries(options)) {\n      creatEle.setAttribute(key, value);\n    }\n    selector.parentNode.insertBefore(creatEle, selector);\n    creatEle.appendChild(selector);\n  },\n\n  isHidden: ele => ele.offsetHeight === 0 && ele.offsetWidth === 0,\n\n  getEleTop: ele => {\n    let actualTop = ele.offsetTop;\n    let current = ele.offsetParent;\n\n    while (current !== null) {\n      actualTop += current.offsetTop;\n      current = current.offsetParent;\n    }\n\n    return actualTop;\n  },\n\n  loadLightbox: ele => {\n    const service = GLOBAL_CONFIG.lightbox;\n\n    if (service === \"mediumZoom\") {\n      const zoom = mediumZoom(ele);\n      zoom.on(\"open\", e => {\n        const photoBg = document.documentElement.getAttribute(\"data-theme\") === \"dark\" ? \"#121212\" : \"#fff\";\n        zoom.update({\n          background: photoBg,\n        });\n      });\n    }\n\n    if (service === \"fancybox\") {\n      Array.from(ele).forEach(i => {\n        if (i.parentNode.tagName !== \"A\") {\n          const dataSrc = i.dataset.lazySrc || i.src;\n          const dataCaption = i.title || i.alt || \"\";\n          anzhiyu.wrap(i, \"a\", {\n            href: dataSrc,\n            \"data-fancybox\": \"gallery\",\n            \"data-caption\": dataCaption,\n            \"data-thumb\": dataSrc,\n          });\n        }\n      });\n\n      if (!window.fancyboxRun) {\n        Fancybox.bind(\"[data-fancybox]\", {\n          Hash: false,\n          Thumbs: {\n            autoStart: false,\n          },\n        });\n        window.fancyboxRun = true;\n      }\n    }\n  },\n\n  setLoading: {\n    add: ele => {\n      const html = `\n        <div class=\"loading-container\">\n          <div class=\"loading-item\">\n            <div></div><div></div><div></div><div></div><div></div>\n          </div>\n        </div>\n      `;\n      ele.insertAdjacentHTML(\"afterend\", html);\n    },\n    remove: ele => {\n      ele.nextElementSibling.remove();\n    },\n  },\n\n  updateAnchor: anchor => {\n    if (anchor !== window.location.hash) {\n      if (!anchor) anchor = location.pathname;\n      const title = GLOBAL_CONFIG_SITE.title;\n      window.history.replaceState(\n        {\n          url: location.href,\n          title,\n        },\n        title,\n        anchor\n      );\n    }\n  },\n\n  getScrollPercent: (currentTop, ele) => {\n    const docHeight = ele.clientHeight;\n    const winHeight = document.documentElement.clientHeight;\n    const headerHeight = ele.offsetTop;\n    const contentMath =\n      docHeight > winHeight ? docHeight - winHeight : document.documentElement.scrollHeight - winHeight;\n    const scrollPercent = (currentTop - headerHeight) / contentMath;\n    const scrollPercentRounded = Math.round(scrollPercent * 100);\n    const percentage = scrollPercentRounded > 100 ? 100 : scrollPercentRounded <= 0 ? 0 : scrollPercentRounded;\n    return percentage;\n  },\n\n  addGlobalFn: (key, fn, name = false, parent = window) => {\n    const globalFn = parent.globalFn || {};\n    const keyObj = globalFn[key] || {};\n\n    if (name && keyObj[name]) return;\n\n    name = name || Object.keys(keyObj).length;\n    keyObj[name] = fn;\n    globalFn[key] = keyObj;\n    parent.globalFn = globalFn;\n  },\n\n  addEventListenerPjax: (ele, event, fn, option = false) => {\n    ele.addEventListener(event, fn, option);\n    anzhiyu.addGlobalFn(\"pjax\", () => {\n      ele.removeEventListener(event, fn, option);\n    });\n  },\n\n  removeGlobalFnEvent: (key, parent = window) => {\n    const { globalFn = {} } = parent;\n    const keyObj = globalFn[key] || {};\n    const keyArr = Object.keys(keyObj);\n    if (!keyArr.length) return;\n    keyArr.forEach(i => {\n      keyObj[i]();\n    });\n    delete parent.globalFn[key];\n  },\n\n  //更改主题色\n  changeThemeMetaColor: function (color) {\n    // console.info(`%c ${color}`, `font-size:36px;color:${color};`);\n    if (themeColorMeta !== null) {\n      themeColorMeta.setAttribute(\"content\", color);\n    }\n  },\n\n  //顶栏自适应主题色\n  initThemeColor: function () {\n    let themeColor = getComputedStyle(document.documentElement)\n      .getPropertyValue(\"--anzhiyu-bar-background\")\n      .trim()\n      .replace('\"', \"\")\n      .replace('\"', \"\");\n    const currentTop = window.scrollY || document.documentElement.scrollTop;\n    if (currentTop > 26) {\n      if (anzhiyu.is_Post()) {\n        themeColor = getComputedStyle(document.documentElement)\n          .getPropertyValue(\"--anzhiyu-meta-theme-post-color\")\n          .trim()\n          .replace('\"', \"\")\n          .replace('\"', \"\");\n      }\n      if (themeColorMeta.getAttribute(\"content\") === themeColor) return;\n      this.changeThemeMetaColor(themeColor);\n    } else {\n      if (themeColorMeta.getAttribute(\"content\") === themeColor) return;\n      this.changeThemeMetaColor(themeColor);\n    }\n  },\n  //是否是文章页\n  is_Post: function () {\n    var url = window.location.href; //获取url\n    if (url.indexOf(\"/posts/\") >= 0) {\n      //判断url地址中是否包含code字符串\n      return true;\n    } else {\n      return false;\n    }\n  },\n  //监测是否在页面开头\n  addNavBackgroundInit: function () {\n    var scrollTop = 0,\n      bodyScrollTop = 0,\n      documentScrollTop = 0;\n    if ($bodyWrap) {\n      bodyScrollTop = $bodyWrap.scrollTop;\n    }\n    if (document.documentElement) {\n      documentScrollTop = document.documentElement.scrollTop;\n    }\n    scrollTop = bodyScrollTop - documentScrollTop > 0 ? bodyScrollTop : documentScrollTop;\n\n    if (scrollTop != 0) {\n      pageHeaderEl.classList.add(\"nav-fixed\");\n      pageHeaderEl.classList.add(\"nav-visible\");\n    }\n  },\n  // 下载图片\n  downloadImage: function (imgsrc, name) {\n    //下载图片地址和图片名\n    rm.hideRightMenu();\n    if (rm.downloadimging == false) {\n      rm.downloadimging = true;\n      anzhiyu.snackbarShow(\"正在下载中，请稍后\", false, 10000);\n      setTimeout(function () {\n        let image = new Image();\n        // 解决跨域 Canvas 污染问题\n        image.setAttribute(\"crossOrigin\", \"anonymous\");\n        image.onload = function () {\n          let canvas = document.createElement(\"canvas\");\n          canvas.width = image.width;\n          canvas.height = image.height;\n          let context = canvas.getContext(\"2d\");\n          context.drawImage(image, 0, 0, image.width, image.height);\n          let url = canvas.toDataURL(\"image/png\"); //得到图片的base64编码数据\n          let a = document.createElement(\"a\"); // 生成一个a元素\n          let event = new MouseEvent(\"click\"); // 创建一个单击事件\n          a.download = name || \"photo\"; // 设置图片名称\n          a.href = url; // 将生成的URL设置为a.href属性\n          a.dispatchEvent(event); // 触发a的单击事件\n        };\n        image.src = imgsrc;\n        anzhiyu.snackbarShow(\"图片已添加盲水印，请遵守版权协议\");\n        rm.downloadimging = false;\n      }, \"10000\");\n    } else {\n      anzhiyu.snackbarShow(\"有正在进行中的下载，请稍后再试\");\n    }\n  },\n  //禁止图片右键单击\n  stopImgRightDrag: function () {\n    var img = document.getElementsByTagName(\"img\");\n    for (var i = 0; i < img.length; i++) {\n      img[i].addEventListener(\"dragstart\", function () {\n        return false;\n      });\n    }\n  },\n  //滚动到指定id\n  scrollTo: function (id) {\n    var domTop = document.querySelector(id).offsetTop;\n    window.scrollTo(0, domTop - 80);\n  },\n  //隐藏侧边栏\n  hideAsideBtn: () => {\n    // Hide aside\n    const $htmlDom = document.documentElement.classList;\n    $htmlDom.contains(\"hide-aside\")\n      ? saveToLocal.set(\"aside-status\", \"show\", 2)\n      : saveToLocal.set(\"aside-status\", \"hide\", 2);\n    $htmlDom.toggle(\"hide-aside\");\n    $htmlDom.contains(\"hide-aside\")\n      ? document.querySelector(\"#consoleHideAside\").classList.add(\"on\")\n      : document.querySelector(\"#consoleHideAside\").classList.remove(\"on\");\n  },\n  // 热评切换\n  switchCommentBarrage: function () {\n    let commentBarrage = document.querySelector(\".comment-barrage\");\n    let menuCommentBarrageText = document.querySelector(\".menu-commentBarrage-text\");\n    let consoleCommentBarrage = document.querySelector(\"#consoleCommentBarrage\");\n    \n    // 检查必要元素是否都存在\n    if (!commentBarrage || !menuCommentBarrageText || !consoleCommentBarrage) {\n      anzhiyu.snackbarShow(\"❌ 评论弹幕功能未开启\");\n      rm && rm.hideRightMenu();\n      return;\n    }\n    \n    if (window.getComputedStyle(commentBarrage).display === \"flex\") {\n      commentBarrage.style.display = \"none\";\n      anzhiyu.snackbarShow(\"✨ 已关闭评论弹幕\");\n      menuCommentBarrageText.textContent = \"显示热评\";\n      consoleCommentBarrage.classList.remove(\"on\");\n      localStorage.setItem(\"commentBarrageSwitch\", \"false\");\n    } else {\n      commentBarrage.style.display = \"flex\";\n      menuCommentBarrageText.textContent = \"关闭热评\";\n      consoleCommentBarrage.classList.add(\"on\");\n      anzhiyu.snackbarShow(\"✨ 已开启评论弹幕\");\n      localStorage.removeItem(\"commentBarrageSwitch\");\n    }\n    rm && rm.hideRightMenu();\n  },\n  initPaginationObserver: () => {\n    const commentElement = document.getElementById(\"post-comment\");\n    const paginationElement = document.getElementById(\"pagination\");\n\n    if (commentElement && paginationElement) {\n      new IntersectionObserver(entries => {\n        const commentBarrage = document.querySelector(\".comment-barrage\");\n\n        entries.forEach(entry => {\n          if (entry.isIntersecting) {\n            paginationElement.classList.add(\"show-window\");\n            if (commentBarrage) {\n              commentBarrage.style.bottom = \"-200px\";\n            }\n          } else {\n            paginationElement.classList.remove(\"show-window\");\n            if (commentBarrage) {\n              commentBarrage.style.bottom = \"0px\";\n            }\n          }\n        });\n      }).observe(commentElement);\n    }\n  },\n  // 初始化即刻\n  initIndexEssay: function () {\n    if (!document.getElementById(\"bbTimeList\")) return;\n    \n    // 创建一个函数来检查 Swiper 是否加载完成\n    const checkSwiper = (retryCount = 0, maxRetries = 10) => {\n      if (typeof Swiper !== 'undefined') {\n        // Swiper 已加载，执行初始化\n        try {\n          let essay_bar_swiper = new Swiper(\".essay_bar_swiper_container\", {\n            passiveListeners: true,\n            direction: \"vertical\",\n            loop: true,\n            autoplay: {\n              disableOnInteraction: true,\n              delay: 3000,\n            },\n            mousewheel: true,\n          });\n\n          let essay_bar_comtainer = document.getElementById(\"bbtalk\");\n          if (essay_bar_comtainer !== null) {\n            essay_bar_comtainer.onmouseenter = function () {\n              essay_bar_swiper.autoplay.stop();\n            };\n            essay_bar_comtainer.onmouseleave = function () {\n              essay_bar_swiper.autoplay.start();\n            };\n          }\n        } catch (error) {\n          console.error('Failed to initialize Swiper:', error);\n        }\n      } else if (retryCount < maxRetries) {\n        // Swiper 未加载，等待 500ms 后重试\n        setTimeout(() => checkSwiper(retryCount + 1, maxRetries), 500);\n      } else {\n        console.warn('Failed to load Swiper after multiple attempts');\n      }\n    };\n\n    // 开始检查 Swiper 是否加载\n    checkSwiper();\n  },\n  scrollByMouseWheel: function ($list, $target) {\n    const scrollHandler = function (e) {\n      $list.scrollLeft -= e.wheelDelta / 2;\n      e.preventDefault();\n    };\n    $list.addEventListener(\"mousewheel\", scrollHandler, { passive: false });\n    if ($target) {\n      $target.classList.add(\"selected\");\n      $list.scrollLeft = $target.offsetLeft - $list.offsetLeft - ($list.offsetWidth - $target.offsetWidth) / 2;\n    }\n  },\n  // catalog激活\n  catalogActive: function () {\n    const $list = document.getElementById(\"catalog-list\");\n    if ($list) {\n      const pathname = decodeURIComponent(window.location.pathname);\n      const catalogListItems = $list.querySelectorAll(\".catalog-list-item\");\n\n      let $catalog = null;\n      catalogListItems.forEach(item => {\n        if (pathname.startsWith(item.id)) {\n          $catalog = item;\n          return;\n        }\n      });\n\n      anzhiyu.scrollByMouseWheel($list, $catalog);\n    }\n  },\n  // Page Tag 激活\n  tagsPageActive: function () {\n    const $list = document.getElementById(\"tag-page-tags\");\n    if ($list) {\n      const $tagPageTags = document.getElementById(decodeURIComponent(window.location.pathname));\n      anzhiyu.scrollByMouseWheel($list, $tagPageTags);\n    }\n  },\n  // 修改时间显示\"最近\"\n  diffDate: function (d, more = false, simple = false) {\n    const dateNow = new Date();\n    const datePost = new Date(d);\n    const dateDiff = dateNow.getTime() - datePost.getTime();\n    const minute = 1000 * 60;\n    const hour = minute * 60;\n    const day = hour * 24;\n    const month = day * 30;\n\n    let result;\n    if (more) {\n      const monthCount = dateDiff / month;\n      const dayCount = dateDiff / day;\n      const hourCount = dateDiff / hour;\n      const minuteCount = dateDiff / minute;\n\n      if (monthCount >= 1) {\n        result = datePost.toLocaleDateString().replace(/\\//g, \"-\");\n      } else if (dayCount >= 1) {\n        result = parseInt(dayCount) + \" \" + GLOBAL_CONFIG.date_suffix.day;\n      } else if (hourCount >= 1) {\n        result = parseInt(hourCount) + \" \" + GLOBAL_CONFIG.date_suffix.hour;\n      } else if (minuteCount >= 1) {\n        result = parseInt(minuteCount) + \" \" + GLOBAL_CONFIG.date_suffix.min;\n      } else {\n        result = GLOBAL_CONFIG.date_suffix.just;\n      }\n    } else if (simple) {\n      const monthCount = dateDiff / month;\n      const dayCount = dateDiff / day;\n      const hourCount = dateDiff / hour;\n      const minuteCount = dateDiff / minute;\n      if (monthCount >= 1) {\n        result = datePost.toLocaleDateString().replace(/\\//g, \"-\");\n      } else if (dayCount >= 1 && dayCount <= 3) {\n        result = parseInt(dayCount) + \" \" + GLOBAL_CONFIG.date_suffix.day;\n      } else if (dayCount > 3) {\n        result = datePost.getMonth() + 1 + \"/\" + datePost.getDate();\n      } else if (hourCount >= 1) {\n        result = parseInt(hourCount) + \" \" + GLOBAL_CONFIG.date_suffix.hour;\n      } else if (minuteCount >= 1) {\n        result = parseInt(minuteCount) + \" \" + GLOBAL_CONFIG.date_suffix.min;\n      } else {\n        result = GLOBAL_CONFIG.date_suffix.just;\n      }\n    } else {\n      result = parseInt(dateDiff / day);\n    }\n    return result;\n  },\n\n  // 修改即刻中的时间显示\n  changeTimeInEssay: function () {\n    document.querySelector(\"#bber\") &&\n      document.querySelectorAll(\"#bber time\").forEach(function (e) {\n        var t = e,\n          datetime = t.getAttribute(\"datetime\");\n        (t.innerText = anzhiyu.diffDate(datetime, true)), (t.style.display = \"inline\");\n      });\n  },\n  // 修改相册集中的时间\n  changeTimeInAlbumDetail: function () {\n    document.querySelector(\"#album_detail\") &&\n      document.querySelectorAll(\"#album_detail time\").forEach(function (e) {\n        var t = e,\n          datetime = t.getAttribute(\"datetime\");\n        (t.innerText = anzhiyu.diffDate(datetime, true)), (t.style.display = \"inline\");\n      });\n  },\n  // 刷新瀑布流\n  reflashEssayWaterFall: function () {\n    const waterfallEl = document.getElementById(\"waterfall\");\n    if (waterfallEl) {\n      setTimeout(function () {\n        waterfall(waterfallEl);\n        waterfallEl.classList.add(\"show\");\n      }, 800);\n    }\n  },\n  sayhi: function () {\n    const $sayhiEl = document.getElementById(\"author-info__sayhi\");\n\n    const getTimeState = () => {\n      const hour = new Date().getHours();\n      let message = \"\";\n\n      if (hour >= 0 && hour <= 5) {\n        message = \"睡个好觉，保证精力充沛\";\n      } else if (hour > 5 && hour <= 10) {\n        message = \"一日之计在于晨\";\n      } else if (hour > 10 && hour <= 14) {\n        message = \"吃饱了才有力气干活\";\n      } else if (hour > 14 && hour <= 18) {\n        message = \"集中精力，攻克难关\";\n      } else if (hour > 18 && hour <= 24) {\n        message = \"不要太劳累了，早睡更健康\";\n      }\n\n      return message;\n    };\n\n    if ($sayhiEl) {\n      $sayhiEl.innerHTML = getTimeState();\n    }\n  },\n\n  // 友链注入预设评论\n  addFriendLink() {\n    var input = document.getElementsByClassName(\"el-textarea__inner\")[0];\n    if (!input) return;\n    const evt = new Event(\"input\", { cancelable: true, bubbles: true });\n    const defaultPlaceholder =\n      \"昵称（请勿包含博客等字样）：\\n网站地址（要求博客地址，请勿提交个人主页）：\\n头像图片url（请提供尽可能清晰的图片，我会上传到我自己的图床）：\\n描述：\\n站点截图（可选）：\\n\";\n    input.value = this.getConfigIfPresent(GLOBAL_CONFIG.linkPageTop, \"addFriendPlaceholder\", defaultPlaceholder);\n    input.dispatchEvent(evt);\n    input.focus();\n    input.setSelectionRange(-1, -1);\n  },\n  // 获取配置，如果为空则返回默认值\n  getConfigIfPresent: function (config, configKey, defaultValue) {\n    if (!config) return defaultValue;\n    if (!config.hasOwnProperty(configKey)) return defaultValue;\n    if (!config[configKey]) return defaultValue;\n    return config[configKey];\n  },\n  //切换音乐播放状态\n  musicToggle: function (changePaly = true) {\n    if (!anzhiyu_musicFirst) {\n      anzhiyu.musicBindEvent();\n      anzhiyu_musicFirst = true;\n    }\n    let msgPlay = '<i class=\"anzhiyufont anzhiyu-icon-play\"></i><span>播放音乐</span>';\n    let msgPause = '<i class=\"anzhiyufont anzhiyu-icon-pause\"></i><span>暂停音乐</span>';\n    if (anzhiyu_musicPlaying) {\n      navMusicEl.classList.remove(\"playing\");\n      document.getElementById(\"menu-music-toggle\").innerHTML = msgPlay;\n      document.getElementById(\"nav-music-hoverTips\").innerHTML = \"音乐已暂停\";\n      document.querySelector(\"#consoleMusic\").classList.remove(\"on\");\n      anzhiyu_musicPlaying = false;\n      navMusicEl.classList.remove(\"stretch\");\n    } else {\n      navMusicEl.classList.add(\"playing\");\n      document.getElementById(\"menu-music-toggle\").innerHTML = msgPause;\n      document.querySelector(\"#consoleMusic\").classList.add(\"on\");\n      anzhiyu_musicPlaying = true;\n      navMusicEl.classList.add(\"stretch\");\n    }\n    if (changePaly) document.querySelector(\"#nav-music meting-js\").aplayer.toggle();\n    rm && rm.hideRightMenu();\n  },\n  // 音乐伸缩\n  musicTelescopic: function () {\n    if (navMusicEl.classList.contains(\"stretch\")) {\n      navMusicEl.classList.remove(\"stretch\");\n    } else {\n      navMusicEl.classList.add(\"stretch\");\n    }\n  },\n\n  //音乐上一曲\n  musicSkipBack: function () {\n    navMusicEl.querySelector(\"meting-js\").aplayer.skipBack();\n    rm && rm.hideRightMenu();\n  },\n\n  //音乐下一曲\n  musicSkipForward: function () {\n    navMusicEl.querySelector(\"meting-js\").aplayer.skipForward();\n    rm && rm.hideRightMenu();\n  },\n\n  //获取音乐中的名称\n  musicGetName: function () {\n    var x = document.querySelectorAll(\".aplayer-title\");\n    var arr = [];\n    for (var i = x.length - 1; i >= 0; i--) {\n      arr[i] = x[i].innerText;\n    }\n    return arr[0];\n  },\n\n  //初始化console图标\n  initConsoleState: function () {\n    //初始化隐藏边栏\n    const $htmlDomClassList = document.documentElement.classList;\n    $htmlDomClassList.contains(\"hide-aside\")\n      ? document.querySelector(\"#consoleHideAside\").classList.add(\"on\")\n      : document.querySelector(\"#consoleHideAside\").classList.remove(\"on\");\n  },\n\n  // 显示打赏中控台\n  rewardShowConsole: function () {\n    // 判断是否为赞赏打开控制台\n    consoleEl.classList.add(\"reward-show\");\n    anzhiyu.initConsoleState();\n  },\n  // 显示中控台\n  showConsole: function () {\n    consoleEl.classList.add(\"show\");\n    anzhiyu.initConsoleState();\n  },\n\n  //隐藏中控台\n  hideConsole: function () {\n    if (consoleEl.classList.contains(\"show\")) {\n      // 如果是一般控制台，就关闭一般控制台\n      consoleEl.classList.remove(\"show\");\n    } else if (consoleEl.classList.contains(\"reward-show\")) {\n      // 如果是打赏控制台，就关闭打赏控制台\n      consoleEl.classList.remove(\"reward-show\");\n    }\n    // 获取center-console元素\n    const centerConsole = document.getElementById(\"center-console\");\n\n    // 检查center-console是否被选中\n    if (centerConsole.checked) {\n      // 取消选中状态\n      centerConsole.checked = false;\n    }\n  },\n  // 取消加载动画\n  hideLoading: function () {\n    document.getElementById(\"loading-box\").classList.add(\"loaded\");\n  },\n  // 将音乐缓存播放\n  cacheAndPlayMusic() {\n    let data = localStorage.getItem(\"musicData\");\n    if (data) {\n      data = JSON.parse(data);\n      const currentTime = new Date().getTime();\n      if (currentTime - data.timestamp < 24 * 60 * 60 * 1000) {\n        // 如果缓存的数据没有过期，直接使用\n        anzhiyu.playMusic(data.songs);\n        return;\n      }\n    }\n\n    // 否则重新从服务器获取数据\n    fetch(\"/json/music.json\")\n      .then(response => response.json())\n      .then(songs => {\n        const cacheData = {\n          timestamp: new Date().getTime(),\n          songs: songs,\n        };\n        localStorage.setItem(\"musicData\", JSON.stringify(cacheData));\n        anzhiyu.playMusic(songs);\n      });\n  },\n  // 播放音乐\n  playMusic(songs) {\n    const anMusicPage = document.getElementById(\"anMusic-page\");\n    const metingAplayer = anMusicPage.querySelector(\"meting-js\").aplayer;\n    const randomIndex = Math.floor(Math.random() * songs.length);\n    const randomSong = songs[randomIndex];\n    const allAudios = metingAplayer.list.audios;\n    if (!selectRandomSong.includes(randomSong.name)) {\n      // 如果随机到的歌曲已经未被随机到过，就添加进metingAplayer.list\n      metingAplayer.list.add([randomSong]);\n      // 播放最后一首(因为是添加到了最后)\n      metingAplayer.list.switch(allAudios.length);\n      // 添加到已被随机的歌曲列表\n      selectRandomSong.push(randomSong.name);\n    } else {\n      // 随机到的歌曲已经在播放列表中了\n      // 直接继续随机直到随机到没有随机过的歌曲，如果全部随机过了就切换到对应的歌曲播放即可\n      let songFound = false;\n      while (!songFound) {\n        const newRandomIndex = Math.floor(Math.random() * songs.length);\n        const newRandomSong = songs[newRandomIndex];\n        if (!selectRandomSong.includes(newRandomSong.name)) {\n          metingAplayer.list.add([newRandomSong]);\n          metingAplayer.list.switch(allAudios.length);\n          selectRandomSong.push(newRandomSong.name);\n          songFound = true;\n        }\n        // 如果全部歌曲都已被随机过，跳出循环\n        if (selectRandomSong.length === songs.length) {\n          break;\n        }\n      }\n      if (!songFound) {\n        // 如果全部歌曲都已被随机过，切换到对应的歌曲播放\n        const palyMusicIndex = allAudios.findIndex(song => song.name === randomSong.name);\n        if (palyMusicIndex != -1) metingAplayer.list.switch(palyMusicIndex);\n      }\n    }\n\n    console.info(\"已随机歌曲：\", selectRandomSong, \"本次随机歌曲：\", randomSong.name);\n  },\n  // 音乐节目切换背景\n  changeMusicBg: function (isChangeBg = true) {\n    const anMusicBg = document.getElementById(\"an_music_bg\");\n\n    if (isChangeBg) {\n      // player listswitch 会进入此处\n      const musiccover = document.querySelector(\"#anMusic-page .aplayer-pic\");\n      anMusicBg.style.backgroundImage = musiccover.style.backgroundImage;\n    } else {\n      // 第一次进入，绑定事件，改背景\n      let timer = setInterval(() => {\n        const musiccover = document.querySelector(\"#anMusic-page .aplayer-pic\");\n        // 确保player加载完成\n        if (musiccover) {\n          clearInterval(timer);\n          // 绑定事件\n          anzhiyu.addEventListenerMusic();\n          // 确保第一次能够正确替换背景\n          anzhiyu.changeMusicBg();\n\n          // 暂停nav的音乐\n          if (\n            document.querySelector(\"#nav-music meting-js\").aplayer &&\n            !document.querySelector(\"#nav-music meting-js\").aplayer.audio.paused\n          ) {\n            anzhiyu.musicToggle();\n          }\n        }\n      }, 100);\n    }\n  },\n  // 获取自定义播放列表\n  getCustomPlayList: function () {\n    if (!window.location.pathname.startsWith(\"/music/\")) {\n      return;\n    }\n    const urlParams = new URLSearchParams(window.location.search);\n    const userId = \"8152976493\";\n    const userServer = \"netease\";\n    const anMusicPageMeting = document.getElementById(\"anMusic-page-meting\");\n    if (urlParams.get(\"id\") && urlParams.get(\"server\")) {\n      const id = urlParams.get(\"id\");\n      const server = urlParams.get(\"server\");\n      anMusicPageMeting.innerHTML = `<meting-js id=\"${id}\" server=${server} type=\"playlist\" type=\"playlist\" mutex=\"true\" preload=\"auto\" theme=\"var(--anzhiyu-main)\" order=\"list\" list-max-height=\"calc(100vh - 169px)!important\"></meting-js>`;\n    } else {\n      anMusicPageMeting.innerHTML = `<meting-js id=\"${userId}\" server=\"${userServer}\" type=\"playlist\" mutex=\"true\" preload=\"auto\" theme=\"var(--anzhiyu-main)\" order=\"list\" list-max-height=\"calc(100vh - 169px)!important\"></meting-js>`;\n    }\n    anzhiyu.changeMusicBg(false);\n  },\n  //隐藏今日推荐\n  hideTodayCard: function () {\n    if (document.getElementById(\"todayCard\")) {\n      document.getElementById(\"todayCard\").classList.add(\"hide\");\n      const topGroup = document.querySelector(\".topGroup\");\n      const recentPostItems = topGroup.querySelectorAll(\".recent-post-item\");\n      recentPostItems.forEach(item => {\n        item.style.display = \"flex\";\n      });\n    }\n  },\n\n  // 监听音乐背景改变\n  addEventListenerMusic: function () {\n    const anMusicPage = document.getElementById(\"anMusic-page\");\n    const aplayerIconMenu = anMusicPage.querySelector(\".aplayer-info .aplayer-time .aplayer-icon-menu\");\n    const anMusicBtnGetSong = anMusicPage.querySelector(\"#anMusicBtnGetSong\");\n    const anMusicRefreshBtn = anMusicPage.querySelector(\"#anMusicRefreshBtn\");\n    const anMusicSwitchingBtn = anMusicPage.querySelector(\"#anMusicSwitching\");\n    const metingAplayer = anMusicPage.querySelector(\"meting-js\").aplayer;\n    //初始化音量\n    metingAplayer.volume(0.8, true);\n    metingAplayer.on(\"loadeddata\", function () {\n      anzhiyu.changeMusicBg();\n    });\n\n    aplayerIconMenu.addEventListener(\"click\", function () {\n      document.getElementById(\"menu-mask\").style.display = \"block\";\n      document.getElementById(\"menu-mask\").style.animation = \"0.5s ease 0s 1 normal none running to_show\";\n      anMusicPage.querySelector(\".aplayer.aplayer-withlist .aplayer-list\").style.opacity = \"1\";\n    });\n\n    function anMusicPageMenuAask() {\n      if (window.location.pathname != \"/music/\") {\n        document.getElementById(\"menu-mask\").removeEventListener(\"click\", anMusicPageMenuAask);\n        return;\n      }\n\n      anMusicPage.querySelector(\".aplayer-list\").classList.remove(\"aplayer-list-hide\");\n    }\n\n    document.getElementById(\"menu-mask\").addEventListener(\"click\", anMusicPageMenuAask);\n\n    // 监听增加单曲按钮\n    anMusicBtnGetSong.addEventListener(\"click\", () => {\n      if (changeMusicListFlag) {\n        const anMusicPage = document.getElementById(\"anMusic-page\");\n        const metingAplayer = anMusicPage.querySelector(\"meting-js\").aplayer;\n        const allAudios = metingAplayer.list.audios;\n        const randomIndex = Math.floor(Math.random() * allAudios.length);\n        // 随机播放一首\n        metingAplayer.list.switch(randomIndex);\n      } else {\n        anzhiyu.cacheAndPlayMusic();\n      }\n    });\n    anMusicRefreshBtn.addEventListener(\"click\", () => {\n      localStorage.removeItem(\"musicData\");\n      anzhiyu.snackbarShow(\"已移除相关缓存歌曲\");\n    });\n    anMusicSwitchingBtn.addEventListener(\"click\", () => {\n      anzhiyu.changeMusicList();\n    });\n\n    // 默认加载的歌单\n    if (GLOBAL_CONFIG.music_page_default === \"custom\") {\n      anzhiyu.changeMusicList();\n    }\n\n    // 监听键盘事件\n    //空格控制音乐\n    document.addEventListener(\"keydown\", function (event) {\n      //暂停开启音乐\n      if (event.code === \"Space\") {\n        event.preventDefault();\n        metingAplayer.toggle();\n      }\n      //切换下一曲\n      if (event.keyCode === 39) {\n        event.preventDefault();\n        metingAplayer.skipForward();\n      }\n      //切换上一曲\n      if (event.keyCode === 37) {\n        event.preventDefault();\n        metingAplayer.skipBack();\n      }\n      //增加音量\n      if (event.keyCode === 38) {\n        if (musicVolume <= 1) {\n          musicVolume += 0.1;\n          metingAplayer.volume(musicVolume, true);\n        }\n      }\n      //减小音量\n      if (event.keyCode === 40) {\n        if (musicVolume >= 0) {\n          musicVolume += -0.1;\n          metingAplayer.volume(musicVolume, true);\n        }\n      }\n    });\n  },\n  // 切换歌单\n  changeMusicList: async function () {\n    const anMusicPage = document.getElementById(\"anMusic-page\");\n    const metingAplayer = anMusicPage.querySelector(\"meting-js\").aplayer;\n    const currentTime = new Date().getTime();\n    const cacheData = JSON.parse(localStorage.getItem(\"musicData\")) || { timestamp: 0 };\n    let songs = [];\n\n    if (changeMusicListFlag) {\n      songs = defaultPlayMusicList;\n    } else {\n      // 保存当前默认播放列表，以使下次可以切换回来\n      defaultPlayMusicList = metingAplayer.list.audios;\n      // 如果缓存的数据没有过期，直接使用\n      if (currentTime - cacheData.timestamp < 24 * 60 * 60 * 1000) {\n        songs = cacheData.songs;\n      } else {\n        // 否则重新从服务器获取数据\n        const response = await fetch(\"/json/music.json\");\n        songs = await response.json();\n        cacheData.timestamp = currentTime;\n        cacheData.songs = songs;\n        localStorage.setItem(\"musicData\", JSON.stringify(cacheData));\n      }\n    }\n\n    // 清除当前播放列表并添加新的歌曲\n    metingAplayer.list.clear();\n    metingAplayer.list.add(songs);\n\n    // 切换标志位\n    changeMusicListFlag = !changeMusicListFlag;\n  },\n  // 控制台音乐列表监听\n  addEventListenerConsoleMusicList: function () {\n    const navMusic = document.getElementById(\"nav-music\");\n    if (!navMusic) return;\n    navMusic.addEventListener(\"click\", e => {\n      const aplayerList = navMusic.querySelector(\".aplayer-list\");\n      const listBtn = navMusic.querySelector(\n        \"div.aplayer-info > div.aplayer-controller > div.aplayer-time.aplayer-time-narrow > button.aplayer-icon.aplayer-icon-menu svg\"\n      );\n      if (e.target != listBtn && aplayerList.classList.contains(\"aplayer-list-hide\")) {\n        aplayerList.classList.remove(\"aplayer-list-hide\");\n      }\n    });\n  },\n  // 监听按键\n  toPage: function () {\n    var toPageText = document.getElementById(\"toPageText\"),\n      toPageButton = document.getElementById(\"toPageButton\"),\n      pageNumbers = document.querySelectorAll(\".page-number\"),\n      lastPageNumber = Number(pageNumbers[pageNumbers.length - 1].innerHTML),\n      pageNumber = Number(toPageText.value);\n\n    if (!isNaN(pageNumber) && pageNumber >= 1 && Number.isInteger(pageNumber)) {\n      var url = \"/page/\" + (pageNumber > lastPageNumber ? lastPageNumber : pageNumber) + \"/\";\n      toPageButton.href = pageNumber === 1 ? \"/\" : url;\n    } else {\n      toPageButton.href = \"javascript:void(0);\";\n    }\n  },\n\n  //删除多余的class\n  removeBodyPaceClass: function () {\n    document.body.className = \"pace-done\";\n  },\n  // 修改body的type类型以适配css\n  setValueToBodyType: function () {\n    const input = document.getElementById(\"page-type\"); // 获取input元素\n    const value = input.value; // 获取input的value值\n    document.body.dataset.type = value; // 将value值赋值到body的type属性上\n  },\n  //匿名评论\n  addRandomCommentInfo: function () {\n    // 从形容词数组中随机取一个值\n    const randomAdjective = adjectives[Math.floor(Math.random() * adjectives.length)];\n\n    // 从蔬菜水果动物名字数组中随机取一个值\n    const randomName = vegetablesAndFruits[Math.floor(Math.random() * vegetablesAndFruits.length)];\n\n    // 将两个值组合成一个字符串\n    const name = `${randomAdjective}${randomName}`;\n\n    function dr_js_autofill_commentinfos() {\n      var lauthor = [\n          \"#author\",\n          \"input[name='comname']\",\n          \"#inpName\",\n          \"input[name='author']\",\n          \"#ds-dialog-name\",\n          \"#name\",\n          \"input[name='nick']\",\n          \"#comment_author\",\n        ],\n        lmail = [\n          \"#mail\",\n          \"#email\",\n          \"input[name='commail']\",\n          \"#inpEmail\",\n          \"input[name='email']\",\n          \"#ds-dialog-email\",\n          \"input[name='mail']\",\n          \"#comment_email\",\n        ],\n        lurl = [\n          \"#url\",\n          \"input[name='comurl']\",\n          \"#inpHomePage\",\n          \"#ds-dialog-url\",\n          \"input[name='url']\",\n          \"input[name='website']\",\n          \"#website\",\n          \"input[name='link']\",\n          \"#comment_url\",\n        ];\n      for (var i = 0; i < lauthor.length; i++) {\n        var author = document.querySelector(lauthor[i]);\n        if (author != null) {\n          author.value = name;\n          author.dispatchEvent(new Event(\"input\"));\n          author.dispatchEvent(new Event(\"change\"));\n          break;\n        }\n      }\n      for (var j = 0; j < lmail.length; j++) {\n        var mail = document.querySelector(lmail[j]);\n        if (mail != null) {\n          mail.value = visitorMail;\n          mail.dispatchEvent(new Event(\"input\"));\n          mail.dispatchEvent(new Event(\"change\"));\n          break;\n        }\n      }\n      return !1;\n    }\n\n    dr_js_autofill_commentinfos();\n    var input = document.getElementsByClassName(\"el-textarea__inner\")[0];\n    input.focus();\n    input.setSelectionRange(-1, -1);\n  },\n\n  // 跳转开往\n  totraveling: function () {\n    window.open(\"https://www.travellings.cn/go.html\", \"_blank\");\n  },\n\n  // 工具函数替换字符串\n  replaceAll: function (e, n, t) {\n    return e.split(n).join(t);\n  },\n\n  // 音乐绑定事件\n  musicBindEvent: function () {\n    document.querySelector(\"#nav-music .aplayer-music\").addEventListener(\"click\", function () {\n      anzhiyu.musicTelescopic();\n    });\n    document.querySelector(\"#nav-music .aplayer-button\").addEventListener(\"click\", function () {\n      anzhiyu.musicToggle(false);\n    });\n  },\n\n  // 判断是否是移动端\n  hasMobile: function () {\n    let isMobile = false;\n    if (\n      navigator.userAgent.match(\n        /(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i\n      ) ||\n      document.body.clientWidth < 800\n    ) {\n      // 移动端\n      isMobile = true;\n    }\n    return isMobile;\n  },\n\n  // 创建二维码\n  qrcodeCreate: function () {\n    if (document.getElementById(\"qrcode\")) {\n      document.getElementById(\"qrcode\").innerHTML = \"\";\n      var qrcode = new QRCode(document.getElementById(\"qrcode\"), {\n        text: window.location.href,\n        width: 250,\n        height: 250,\n        colorDark: \"#000\",\n        colorLight: \"#ffffff\",\n        correctLevel: QRCode.CorrectLevel.H,\n      });\n    }\n  },\n\n  // 判断是否在el内\n  isInViewPortOfOne: function (el) {\n    if (!el) return;\n    const viewPortHeight = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\n    const offsetTop = el.offsetTop;\n    const scrollTop = document.documentElement.scrollTop;\n    const top = offsetTop - scrollTop;\n    return top <= viewPortHeight;\n  },\n  //添加赞赏蒙版\n  addRewardMask: function () {\n    if (!document.querySelector(\".reward-main\")) return;\n    document.querySelector(\".reward-main\").style.display = \"flex\";\n    document.querySelector(\".reward-main\").style.zIndex = \"102\";\n    document.getElementById(\"quit-box\").style.display = \"flex\";\n  },\n  // 移除赞赏蒙版\n  removeRewardMask: function () {\n    if (!document.querySelector(\".reward-main\")) return;\n    document.querySelector(\".reward-main\").style.display = \"none\";\n    document.getElementById(\"quit-box\").style.display = \"none\";\n  },\n\n  keyboardToggle: function () {\n    const isKeyboardOn = anzhiyu_keyboard;\n\n    if (isKeyboardOn) {\n      const consoleKeyboard = document.querySelector(\"#consoleKeyboard\");\n      consoleKeyboard.classList.remove(\"on\");\n      anzhiyu_keyboard = false;\n    } else {\n      const consoleKeyboard = document.querySelector(\"#consoleKeyboard\");\n      consoleKeyboard.classList.add(\"on\");\n      anzhiyu_keyboard = true;\n    }\n\n    localStorage.setItem(\"keyboardToggle\", isKeyboardOn ? \"false\" : \"true\");\n  },\n  rightMenuToggle: function () {\n    if (window.oncontextmenu) {\n      window.oncontextmenu = null;\n    } else if (!window.oncontextmenu && oncontextmenuFunction) {\n      window.oncontextmenu = oncontextmenuFunction;\n    }\n  },\n  switchConsole: () => {\n    // switch console\n    const consoleEl = document.getElementById(\"console\");\n    //初始化隐藏边栏\n    const $htmlDom = document.documentElement.classList;\n    $htmlDom.contains(\"hide-aside\")\n      ? document.querySelector(\"#consoleHideAside\").classList.add(\"on\")\n      : document.querySelector(\"#consoleHideAside\").classList.remove(\"on\");\n    if (consoleEl.classList.contains(\"show\")) {\n      consoleEl.classList.remove(\"show\");\n    } else {\n      consoleEl.classList.add(\"show\");\n    }\n    const consoleKeyboard = document.querySelector(\"#consoleKeyboard\");\n\n    if (consoleKeyboard) {\n      if (localStorage.getItem(\"keyboardToggle\") === \"true\") {\n        consoleKeyboard.classList.add(\"on\");\n        anzhiyu_keyboard = true;\n      } else {\n        consoleKeyboard.classList.remove(\"on\");\n        anzhiyu_keyboard = false;\n      }\n    }\n  },\n  // 定义 intersectionObserver 函数，并接收两个可选参数\n  intersectionObserver: function (enterCallback, leaveCallback) {\n    let observer;\n    return () => {\n      if (!observer) {\n        observer = new IntersectionObserver(entries => {\n          entries.forEach(entry => {\n            if (entry.intersectionRatio > 0) {\n              enterCallback?.();\n            } else {\n              leaveCallback?.();\n            }\n          });\n        });\n      } else {\n        // 如果 observer 对象已经存在，则先取消对之前元素的观察\n        observer.disconnect();\n      }\n      return observer;\n    };\n  },\n  // CategoryBar滚动\n  scrollCategoryBarToRight: function () {\n    // 获取需要操作的元素\n    const items = document.getElementById(\"catalog-list\");\n    const nextButton = document.getElementById(\"category-bar-next\");\n\n    // 检查元素是否存在\n    if (items && nextButton) {\n      const itemsWidth = items.clientWidth;\n\n      // 判断是否已经滚动到最右侧\n      if (items.scrollLeft + items.clientWidth + 1 >= items.scrollWidth) {\n        // 滚动到初始位置并更新按钮内容\n        items.scroll({\n          left: 0,\n          behavior: \"smooth\",\n        });\n        nextButton.innerHTML = '<i class=\"anzhiyufont anzhiyu-icon-angle-double-right\"></i>';\n      } else {\n        // 滚动到下一个视图\n        items.scrollBy({\n          left: itemsWidth,\n          behavior: \"smooth\",\n        });\n      }\n    } else {\n      console.error(\"Element(s) not found: 'catalog-list' and/or 'category-bar-next'.\");\n    }\n  },\n  // 分类条\n  categoriesBarActive: function () {\n    const urlinfo = decodeURIComponent(window.location.pathname);\n    const $categoryBar = document.getElementById(\"category-bar\");\n    if (!$categoryBar) return;\n\n    if (urlinfo === \"/\") {\n      $categoryBar.querySelector(\"#首页\").classList.add(\"select\");\n    } else {\n      const pattern = /\\/categories\\/.*?\\//;\n      const patbool = pattern.test(urlinfo);\n      if (!patbool) return;\n\n      const nowCategorie = urlinfo.split(\"/\")[2];\n      $categoryBar.querySelector(`#${nowCategorie}`).classList.add(\"select\");\n    }\n  },\n  topCategoriesBarScroll: function () {\n    const $categoryBarItems = document.getElementById(\"category-bar-items\");\n    if (!$categoryBarItems) return;\n\n    $categoryBarItems.addEventListener(\"mousewheel\", function (e) {\n      const v = -e.wheelDelta / 2;\n      this.scrollLeft += v;\n      e.preventDefault();\n    });\n  },\n  // 切换菜单显示热评\n  switchRightClickMenuHotReview: function () {\n    const postComment = document.getElementById(\"post-comment\");\n    const menuCommentBarrageDom = document.getElementById(\"menu-commentBarrage\");\n    if (postComment) {\n      menuCommentBarrageDom.style.display = \"flex\";\n    } else {\n      menuCommentBarrageDom.style.display = \"none\";\n    }\n  },\n  // 切换作者卡片状态文字\n  changeSayHelloText: function () {\n    const greetings = GLOBAL_CONFIG.authorStatus.skills;\n\n    const authorInfoSayHiElement = document.getElementById(\"author-info__sayhi\");\n\n    // 如果只有一个问候语，设置为默认值\n    if (greetings.length === 1) {\n      authorInfoSayHiElement.textContent = greetings[0];\n      return;\n    }\n\n    let lastSayHello = authorInfoSayHiElement.textContent;\n\n    let randomGreeting = lastSayHello;\n    while (randomGreeting === lastSayHello) {\n      randomGreeting = greetings[Math.floor(Math.random() * greetings.length)];\n    }\n    authorInfoSayHiElement.textContent = randomGreeting;\n  },\n};\n\nconst anzhiyuPopupManager = {\n  queue: [],\n  processing: false,\n  Jump: false,\n\n  enqueuePopup(title, tip, url, duration = 3000) {\n    this.queue.push({ title, tip, url, duration });\n    if (!this.processing) {\n      this.processQueue();\n    }\n  },\n\n  processQueue() {\n    if (this.queue.length > 0 && !this.processing) {\n      this.processing = true;\n      const { title, tip, url, duration } = this.queue.shift();\n      this.popupShow(title, tip, url, duration);\n    }\n  },\n\n  popupShow(title, tip, url, duration) {\n    const popupWindow = document.getElementById(\"popup-window\");\n    if (!popupWindow) return;\n    const windowTitle = popupWindow.querySelector(\".popup-window-title\");\n    const windowContent = popupWindow.querySelector(\".popup-window-content\");\n    const cookiesTip = windowContent.querySelector(\".popup-tip\");\n    if (popupWindow.classList.contains(\"show-popup-window\")) {\n      popupWindow.classList.add(\"popup-hide\");\n    }\n\n    // 等待上一个弹窗完全消失\n    setTimeout(() => {\n      // 移除之前的点击事件处理程序\n      popupWindow.removeEventListener(\"click\", this.clickEventHandler);\n      if (url) {\n        if (window.pjax) {\n          this.clickEventHandler = event => {\n            event.preventDefault();\n            pjax.loadUrl(url);\n            popupWindow.classList.remove(\"show-popup-window\");\n            popupWindow.classList.remove(\"popup-hide\");\n            this.Jump = true;\n\n            // 处理队列中的下一个弹出窗口\n            this.processing = false;\n            this.processQueue();\n          };\n\n          popupWindow.addEventListener(\"click\", this.clickEventHandler);\n        } else {\n          this.clickEventHandler = () => {\n            window.location.href = url;\n          };\n          popupWindow.addEventListener(\"click\", this.clickEventHandler);\n        }\n        if (popupWindow.classList.contains(\"no-url\")) {\n          popupWindow.classList.remove(\"no-url\");\n        }\n      } else {\n        if (!popupWindow.classList.contains(\"no-url\")) {\n          popupWindow.classList.add(\"no-url\");\n        }\n\n        this.clickEventHandler = () => {\n          popupWindow.classList.add(\"popup-hide\");\n          setTimeout(() => {\n            popupWindow.classList.remove(\"popup-hide\");\n            popupWindow.classList.remove(\"show-popup-window\");\n          }, 1000);\n        };\n        popupWindow.addEventListener(\"click\", this.clickEventHandler);\n      }\n\n      if (popupWindow.classList.contains(\"popup-hide\")) {\n        popupWindow.classList.remove(\"popup-hide\");\n      }\n      popupWindow.classList.add(\"show-popup-window\");\n      windowTitle.textContent = title;\n      cookiesTip.textContent = tip;\n    }, 800);\n\n    setTimeout(() => {\n      if (url && !this.Jump) {\n        this.Jump = false;\n      }\n      if (!popupWindow.classList.contains(\"popup-hide\") && popupWindow.className != \"\") {\n        popupWindow.classList.add(\"popup-hide\");\n      }\n\n      // 处理队列中的下一个弹出窗口\n      this.processing = false;\n      this.processQueue();\n    }, duration);\n  },\n};\n"]}