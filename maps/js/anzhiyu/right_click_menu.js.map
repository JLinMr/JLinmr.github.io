{"version":3,"file":"../../../js/anzhiyu/right_click_menu.js","names":["rm","aElements","document","getElementsByTagName","i","length","setAttribute","imgElements","j","showRightMenu","isTrue","x","y","rightMenu","getElementById","style","top","left","display","stopMaskScroll","hideRightMenu","querySelector","rmWidth","offsetWidth","rmHeight","offsetHeight","reloadrmSize","visibility","domhref","domImgSrc","globalEvent","oncontextmenuFunction","event","ctrlKey","body","clientWidth","pageX","clientX","pageY","clientY","$rightMenuOther","$rightMenuPlugin","$rightMenuCopyText","$rightMenuPasteText","$rightMenuCommentText","$rightMenuNewWindow","$rightMenuNewWindowImg","$rightMenuCopyLink","$rightMenuCopyImg","$rightMenuDownloadImg","$rightMenuSearch","$rightMenuSearchBaidu","$rightMenuMusicToggle","$rightMenuMusicBack","$rightMenuMusicForward","$rightMenuMusicPlaylist","$rightMenuMusicCopyMusicName","href","target","imgsrc","currentSrc","pluginMode","selectTextNow","window","getSelection","width","tagName","toLowerCase","navMusicEl","contains","innerWidth","innerHeight","imageToBlob","imageURL","img","Image","c","createElement","ctx","getContext","crossOrigin","src","Promise","resolve","onload","this","naturalWidth","height","naturalHeight","drawImage","toBlob","blob","async","copyImage","item","ClipboardItem","navigator","clipboard","write","addEventListener","e","passive","oncontextmenu","downloadimging","writeClipImg","console","log","anzhiyu","snackbarShow","setTimeout","copyUrl","id","input","appendChild","text","value","select","setSelectionRange","execCommand","remove","rightmenuCopyText","txt","writeText","copyPageUrl","url","location","selceText","selection","createRange","toString","replaceAll","string","search","replace","split","join","addRightMenuClickEvent","history","back","forward","reload","scrollToDest","querySelectorAll","forEach","link","origin","toRandomPost","switchCommentBarrage","preventDefault","pasteText","copyright","GLOBAL_CONFIG","copy","languages","copySuccess","rightMenuCommentText","open","copyLink","downloadImage","searchBing","musicToggle","musicSkipBack","musicSkipForward","musicGetName","onmouseup","ondblclick","readClipboard","readText","then","clipText","insertAtCaret","elemt","startPos","selectionStart","endPos","selectionEnd","focus","scrollTop","substring","domTop","offsetTop","scrollTo","setText","getElementsByClassName","evt","createEvent","initEvent","inputValue","dispatchEvent","classList","add"],"sources":["js/anzhiyu/right_click_menu.js"],"mappings":"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","ignoreList":[],"sourcesContent":["// 初始化函数\nrm = {};\n\n//禁止图片与超链接拖拽\nlet aElements = document.getElementsByTagName(\"a\");\nfor (let i = 0; i < aElements.length; i++) {\n  aElements[i].setAttribute(\"draggable\", \"false\");\n  let imgElements = aElements[i].getElementsByTagName(\"img\");\n  for (let j = 0; j < imgElements.length; j++) {\n    imgElements[j].setAttribute(\"draggable\", \"false\");\n  }\n}\n\n// 显示菜单\nrm.showRightMenu = function (isTrue, x = 0, y = 0) {\n  let rightMenu = document.getElementById(\"rightMenu\");\n  rightMenu.style.top = x + \"px\";\n  rightMenu.style.left = y + \"px\";\n  if (isTrue) {\n    rightMenu.style.display = \"block\";\n    stopMaskScroll();\n  } else {\n    rightMenu.style.display = \"none\";\n  }\n};\n\n// 隐藏菜单\nrm.hideRightMenu = function () {\n  rm.showRightMenu(false);\n  let rightMenuMask = document.querySelector(\"#rightmenu-mask\");\n  rightMenuMask.style.display = \"none\";\n};\n\n// 尺寸\nlet rmWidth = document.getElementById(\"rightMenu\").offsetWidth;\nlet rmHeight = document.getElementById(\"rightMenu\").offsetHeight;\n\n// 重新定义尺寸\nrm.reloadrmSize = function () {\n  rightMenu.style.visibility = \"hidden\";\n  rightMenu.style.display = \"block\";\n  // 获取宽度和高度\n  rmWidth = document.getElementById(\"rightMenu\").offsetWidth;\n  rmHeight = document.getElementById(\"rightMenu\").offsetHeight;\n  rightMenu.style.visibility = \"visible\";\n};\n\n// 获取点击的href\nlet domhref = \"\";\nlet domImgSrc = \"\";\nlet globalEvent = null;\n\nvar oncontextmenuFunction = function (event) {\n  if (event.ctrlKey) {\n    return true;\n  }\n\n  if (document.body.clientWidth > 768) {\n    let pageX = event.clientX + 10; //加10是为了防止显示时鼠标遮在菜单上\n    let pageY = event.clientY;\n\n    //其他额外菜单\n    const $rightMenuOther = document.querySelector(\".rightMenuOther\");\n    const $rightMenuPlugin = document.querySelector(\".rightMenuPlugin\");\n    const $rightMenuCopyText = document.querySelector(\"#menu-copytext\");\n    const $rightMenuPasteText = document.querySelector(\"#menu-pastetext\");\n    const $rightMenuCommentText = document.querySelector(\"#menu-commenttext\");\n    const $rightMenuNewWindow = document.querySelector(\"#menu-newwindow\");\n    const $rightMenuNewWindowImg = document.querySelector(\"#menu-newwindowimg\");\n    const $rightMenuCopyLink = document.querySelector(\"#menu-copylink\");\n    const $rightMenuCopyImg = document.querySelector(\"#menu-copyimg\");\n    const $rightMenuDownloadImg = document.querySelector(\"#menu-downloadimg\");\n    const $rightMenuSearch = document.querySelector(\"#menu-search\");\n    const $rightMenuSearchBaidu = document.querySelector(\"#menu-searchBing\");\n    const $rightMenuMusicToggle = document.querySelector(\"#menu-music-toggle\");\n    const $rightMenuMusicBack = document.querySelector(\"#menu-music-back\");\n    const $rightMenuMusicForward = document.querySelector(\"#menu-music-forward\");\n    const $rightMenuMusicPlaylist = document.querySelector(\"#menu-music-playlist\");\n    const $rightMenuMusicCopyMusicName = document.querySelector(\"#menu-music-copyMusicName\");\n\n    let href = event.target.href;\n    let imgsrc = event.target.currentSrc;\n\n    // 判断模式 扩展模式为有事件\n    let pluginMode = false;\n    $rightMenuOther.style.display = \"block\";\n    globalEvent = event;\n\n    // 检查是否需要复制 是否有选中文本\n    if (selectTextNow && window.getSelection()) {\n      pluginMode = true;\n      $rightMenuCopyText.style.display = \"block\";\n      $rightMenuCommentText.style.display = \"block\";\n      $rightMenuSearch.style.display = \"block\";\n      $rightMenuSearchBaidu.style.display = \"block\";\n    } else {\n      $rightMenuCopyText.style.display = \"none\";\n      $rightMenuCommentText.style.display = \"none\";\n      $rightMenuSearchBaidu.style.display = \"none\";\n      $rightMenuSearch.style.display = \"none\";\n    }\n\n    //检查是否右键点击了链接a标签\n    if (href) {\n      pluginMode = true;\n      $rightMenuNewWindow.style.display = \"block\";\n      $rightMenuCopyLink.style.display = \"block\";\n      domhref = href;\n    } else {\n      $rightMenuNewWindow.style.display = \"none\";\n      $rightMenuCopyLink.style.display = \"none\";\n    }\n\n    //检查是否需要复制图片\n    if (imgsrc) {\n      pluginMode = true;\n      $rightMenuCopyImg.style.display = \"block\";\n      $rightMenuDownloadImg.style.display = \"block\";\n      $rightMenuNewWindowImg.style.display = \"block\";\n      document.getElementById(\"rightMenu\").style.width = \"12rem\";\n      domImgSrc = imgsrc;\n    } else {\n      $rightMenuCopyImg.style.display = \"none\";\n      $rightMenuDownloadImg.style.display = \"none\";\n      $rightMenuNewWindowImg.style.display = \"none\";\n    }\n\n    // 判断是否为输入框\n    if (event.target.tagName.toLowerCase() === \"input\" || event.target.tagName.toLowerCase() === \"textarea\") {\n      pluginMode = true;\n      $rightMenuPasteText.style.display = \"block\";\n    } else {\n      $rightMenuPasteText.style.display = \"none\";\n    }\n    const navMusicEl = document.querySelector(\"#nav-music\");\n    //判断是否是音乐\n    if (navMusicEl && navMusicEl.contains(event.target)) {\n      pluginMode = true;\n      $rightMenuMusicToggle.style.display = \"block\";\n      $rightMenuMusicBack.style.display = \"block\";\n      $rightMenuMusicForward.style.display = \"block\";\n      $rightMenuMusicPlaylist.style.display = \"block\";\n      $rightMenuMusicCopyMusicName.style.display = \"block\";\n    } else {\n      $rightMenuMusicToggle.style.display = \"none\";\n      $rightMenuMusicBack.style.display = \"none\";\n      $rightMenuMusicForward.style.display = \"none\";\n      $rightMenuMusicPlaylist.style.display = \"none\";\n      $rightMenuMusicCopyMusicName.style.display = \"none\";\n    }\n\n    // 如果不是扩展模式则隐藏扩展模块\n    if (pluginMode) {\n      $rightMenuOther.style.display = \"none\";\n      $rightMenuPlugin.style.display = \"block\";\n    } else {\n      $rightMenuPlugin.style.display = \"none\";\n    }\n\n    rm.reloadrmSize();\n\n    // 鼠标默认显示在鼠标右下方，当鼠标靠右或靠下时，将菜单显示在鼠标左方\\上方\n    if (pageX + rmWidth > window.innerWidth) {\n      pageX -= rmWidth + 10;\n    }\n    if (pageY + rmHeight > window.innerHeight) {\n      pageY -= pageY + rmHeight - window.innerHeight;\n    }\n\n    rm.showRightMenu(true, pageY, pageX);\n    document.getElementById(\"rightmenu-mask\").style.display = \"flex\";\n    return false;\n  }\n};\n\n// 监听右键初始化\nwindow.oncontextmenu = oncontextmenuFunction;\n\n// 下载图片状态\nrm.downloadimging = false;\n\n// 复制图片到剪贴板\nrm.writeClipImg = function (imgsrc) {\n  console.log(\"按下复制\");\n  rm.hideRightMenu();\n  anzhiyu.snackbarShow(\"正在下载中，请稍后\", false, 10000);\n  if (rm.downloadimging == false) {\n    rm.downloadimging = true;\n    setTimeout(function () {\n      copyImage(imgsrc);\n      anzhiyu.snackbarShow(\"复制成功！图片已添加盲水印，请遵守版权协议\");\n      rm.downloadimging = false;\n    }, \"10000\");\n  }\n};\n\nfunction imageToBlob(imageURL) {\n  const img = new Image();\n  const c = document.createElement(\"canvas\");\n  const ctx = c.getContext(\"2d\");\n  img.crossOrigin = \"\";\n  img.src = imageURL;\n  return new Promise(resolve => {\n    img.onload = function () {\n      c.width = this.naturalWidth;\n      c.height = this.naturalHeight;\n      ctx.drawImage(this, 0, 0);\n      c.toBlob(\n        blob => {\n          // here the image is a blob\n          resolve(blob);\n        },\n        \"image/png\",\n        0.75\n      );\n    };\n  });\n}\n\nasync function copyImage(imageURL) {\n  const blob = await imageToBlob(imageURL);\n  const item = new ClipboardItem({ \"image/png\": blob });\n  navigator.clipboard.write([item]);\n}\n\nrm.copyUrl = function (id) {\n  const input = document.createElement(\"input\"); // Create a new <input> element\n  input.id = \"copyVal\"; // Set the id of the new element to \"copyVal\"\n  document.body.appendChild(input); // Append the new element to the end of the <body> element\n\n  const text = id;\n  input.value = text;\n  input.select();\n  input.setSelectionRange(0, input.value.length);\n  document.execCommand(\"copy\");\n\n  input.remove(); // Remove the <input> element from the DOM\n};\n\nfunction stopMaskScroll() {\n  if (document.getElementById(\"rightmenu-mask\")) {\n    let xscroll = document.getElementById(\"rightmenu-mask\");\n    xscroll.addEventListener(\n      \"mousewheel\",\n      function (e) {\n        //阻止浏览器默认方法\n        rm.hideRightMenu();\n        // e.preventDefault();\n      },\n      { passive: true }\n    );\n  }\n  if (document.getElementById(\"rightMenu\")) {\n    let xscroll = document.getElementById(\"rightMenu\");\n    xscroll.addEventListener(\n      \"mousewheel\",\n      function (e) {\n        //阻止浏览器默认方法\n        rm.hideRightMenu();\n        // e.preventDefault();\n      },\n      { passive: true }\n    );\n  }\n}\n\nrm.rightmenuCopyText = function (txt) {\n  if (navigator.clipboard) {\n    navigator.clipboard.writeText(txt);\n  }\n  rm.hideRightMenu();\n};\n\nrm.copyPageUrl = function (url) {\n  if (!url) {\n    url = window.location.href;\n  }\n  rm.copyUrl(url);\n  anzhiyu.snackbarShow(\"复制链接地址成功\", false, 2000);\n  rm.hideRightMenu();\n};\n\n// 复制当前选中文本\nvar selectTextNow = \"\";\ndocument.onmouseup = document.ondblclick = selceText;\n\nfunction selceText() {\n  var txt;\n  if (document.selection) {\n    txt = document.selection.createRange().text;\n  } else {\n    txt = window.getSelection().toString();\n  }\n  selectTextNow = txt !== \"\" ? txt : \"\";\n}\n\n// 读取剪切板\nrm.readClipboard = function () {\n  if (navigator.clipboard) {\n    navigator.clipboard.readText().then(clipText => rm.insertAtCaret(globalEvent.target, clipText));\n  }\n};\n\n// 粘贴文本到焦点\nrm.insertAtCaret = function (elemt, value) {\n  const startPos = elemt.selectionStart,\n    endPos = elemt.selectionEnd;\n  if (document.selection) {\n    elemt.focus();\n    var sel = document.selection.createRange();\n    sel.text = value;\n    elemt.focus();\n  } else {\n    if (startPos || startPos == \"0\") {\n      var scrollTop = elemt.scrollTop;\n      elemt.value = elemt.value.substring(0, startPos) + value + elemt.value.substring(endPos, elemt.value.length);\n      elemt.focus();\n      elemt.selectionStart = startPos + value.length;\n      elemt.selectionEnd = startPos + value.length;\n      elemt.scrollTop = scrollTop;\n    } else {\n      elemt.value += value;\n      elemt.focus();\n    }\n  }\n};\n\n//粘贴文本\nrm.pasteText = function () {\n  const result = rm.readClipboard() || \"\";\n  rm.hideRightMenu();\n};\n\n//引用到评论\nrm.rightMenuCommentText = function (txt) {\n  rm.hideRightMenu();\n  const postCommentDom = document.getElementById(\"post-comment\");\n  var domTop = postCommentDom.offsetTop;\n  window.scrollTo(0, domTop - 80);\n  if (txt == \"undefined\" || txt == \"null\") txt = \"好棒！\";\n  function setText() {\n    setTimeout(() => {\n      var input = document.getElementsByClassName(\"el-textarea__inner\")[0];\n      if (!input) setText();\n      let evt = document.createEvent(\"HTMLEvents\");\n      evt.initEvent(\"input\", true, true);\n      let inputValue = replaceAll(txt, \"\\n\", \"\\n> \");\n      input.value = \"> \" + inputValue + \"\\n\\n\";\n      input.dispatchEvent(evt);\n      input.focus();\n      input.setSelectionRange(-1, -1);\n      if (document.getElementById(\"comment-tips\")) {\n        document.getElementById(\"comment-tips\").classList.add(\"show\");\n      }\n    }, 100);\n  }\n  setText();\n};\n\n//替换所有内容\nfunction replaceAll(string, search, replace) {\n  return string.split(search).join(replace);\n}\n\n// 百度搜索\nrm.searchBing = function () {\n  anzhiyu.snackbarShow(\"即将跳转到 Bing 搜索\", false, 2000);\n  setTimeout(function () {\n    window.open(\"https://www.bing.com/search?q=\" + selectTextNow);\n  }, \"2000\");\n  rm.hideRightMenu();\n};\n\n//分享链接\nrm.copyLink = function () {\n  rm.rightmenuCopyText(domhref);\n  anzhiyu.snackbarShow(\"已复制链接地址\");\n};\n\nfunction addRightMenuClickEvent() {\n  // 添加点击事件\n  document.getElementById(\"menu-backward\").addEventListener(\"click\", function () {\n    window.history.back();\n    rm.hideRightMenu();\n  });\n\n  document.getElementById(\"menu-forward\").addEventListener(\"click\", function () {\n    window.history.forward();\n    rm.hideRightMenu();\n  });\n\n  document.getElementById(\"menu-refresh\").addEventListener(\"click\", function () {\n    window.location.reload();\n  });\n\n  document.getElementById(\"menu-top\").addEventListener(\"click\", function () {\n    anzhiyu.scrollToDest(0, 500);\n    rm.hideRightMenu();\n  });\n\n  const menuLinks = document.querySelectorAll(\".menu-link\");\n  menuLinks.forEach(function (link) {\n    link.addEventListener(\"click\", rm.hideRightMenu);\n  });\n\n  document.getElementById(\"menu-home\") &&\n    document.getElementById(\"menu-home\").addEventListener(\"click\", function () {\n      window.location.href = window.location.origin;\n    });\n\n  document.getElementById(\"menu-randomPost\").addEventListener(\"click\", function () {\n    toRandomPost();\n  });\n\n  document.getElementById(\"menu-commentBarrage\").addEventListener(\"click\", anzhiyu.switchCommentBarrage);\n\n  document.getElementById(\"rightmenu-mask\").addEventListener(\"click\", rm.hideRightMenu);\n\n  document.getElementById(\"rightmenu-mask\").addEventListener(\"contextmenu\", function (event) {\n    rm.hideRightMenu();\n    event.preventDefault(); // Prevent the default context menu from appearing\n  });\n\n  document.getElementById(\"menu-copy\").addEventListener(\"click\", () => {\n    rm.copyPageUrl();\n  });\n\n  document.getElementById(\"menu-pastetext\").addEventListener(\"click\", rm.pasteText);\n\n  document.getElementById(\"menu-copytext\").addEventListener(\"click\", function () {\n    rm.rightmenuCopyText(selectTextNow);\n    const copyright = GLOBAL_CONFIG.copyright;\n    if (copyright.copy) {\n      anzhiyu.snackbarShow(copyright.languages.copySuccess);\n    }\n  });\n\n  document.getElementById(\"menu-commenttext\").addEventListener(\"click\", function () {\n    rm.rightMenuCommentText(selectTextNow);\n  });\n\n  document.getElementById(\"menu-newwindow\").addEventListener(\"click\", function () {\n    window.open(domhref, \"_blank\");\n    rm.hideRightMenu();\n  });\n\n  document.getElementById(\"menu-copylink\").addEventListener(\"click\", rm.copyLink);\n\n  document.getElementById(\"menu-downloadimg\").addEventListener(\"click\", function () {\n    anzhiyu.downloadImage(domImgSrc, \"anzhiyu\");\n  });\n\n  document.getElementById(\"menu-newwindowimg\").addEventListener(\"click\", function () {\n    window.open(domImgSrc, \"_blank\");\n    rm.hideRightMenu();\n  });\n\n  document.getElementById(\"menu-copyimg\").addEventListener(\"click\", function () {\n    rm.writeClipImg(domImgSrc);\n  });\n\n  document.getElementById(\"menu-searchBing\").addEventListener(\"click\", rm.searchBing);\n\n  //音乐\n  document.getElementById(\"menu-music-toggle\").addEventListener(\"click\", anzhiyu.musicToggle);\n\n  document.getElementById(\"menu-music-back\").addEventListener(\"click\", anzhiyu.musicSkipBack);\n\n  document.getElementById(\"menu-music-forward\").addEventListener(\"click\", anzhiyu.musicSkipForward);\n\n  document.getElementById(\"menu-music-copyMusicName\").addEventListener(\"click\", function () {\n    rm.rightmenuCopyText(anzhiyu.musicGetName());\n    anzhiyu.snackbarShow(\"复制歌曲名称成功\", false, 3000);\n  });\n}\n\naddRightMenuClickEvent();\n"]}